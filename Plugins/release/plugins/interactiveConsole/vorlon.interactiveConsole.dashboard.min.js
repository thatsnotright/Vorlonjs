var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},VORLON;!function(e){var t=function(t){function n(){t.call(this,"interactiveConsole","control.html","control.css"),this._commandHistory=[],this._logEntries=[],this._ready=!1,this._id="CONSOLE",this.traceLog=function(e){console.log(e)}}return __extends(n,t),n.prototype.startDashboardSide=function(t){var n=this;void 0===t&&(t=null),this._insertHtmlContentAsync(t,function(o){n._containerDiv=e.Tools.QuerySelectorById(o,"logs"),n._clearButton=e.Tools.QuerySelectorById(o,"clear"),n._clearButton.addEventListener("clear",function(){n.sendCommandToClient("clear")}),n._interactiveInput=e.Tools.QuerySelectorById(t,"input"),n._interactiveInput.addEventListener("keydown",function(e){13===e.keyCode&&(n.sendCommandToClient("order",{order:n.isLoggable(n._interactiveInput.value)?"console.log("+n._interactiveInput.value+")":n._interactiveInput.value}),n._commandHistory.push(n._interactiveInput.value),n._commandIndex=null,n._interactiveInput.value=""),38===e.keyCode?(null==n._commandIndex&&(n._commandIndex=n._commandHistory.length),n._commandHistory.length>0&&n._commandIndex>0&&(n._commandIndex--,n._interactiveInput.value=n._commandHistory[n._commandIndex])):40===e.keyCode&&n._commandHistory.length>0&&null!=n._commandIndex&&(n._commandIndex<n._commandHistory.length-1?(n._commandIndex++,n._interactiveInput.value=n._commandHistory[n._commandIndex]):(n._interactiveInput.value="",n._commandIndex=null))});var i=o.querySelector("#filterall"),s=o.querySelectorAll(".filter-btn"),l=function(){var e=[];a(function(t){"filterall"!==t.id&&t.className.match("selected")&&e.push(t.getAttribute("filter"))}),n.applyFilter(e,n._textFilter.value)},r=function(t){e.Tools.RemoveClass(i,"selected"),e.Tools.ToggleClass(t.currentTarget,"selected"),l()},a=function(e){for(var t=0,n=s.length;n>t;t++)e(s[t])};a(function(e){e.onclick=r}),i.onclick=function(){a(function(t){e.Tools.RemoveClass(t,"selected")}),e.Tools.AddClass(i,"selected"),l()},n._textFilter=e.Tools.QuerySelectorById(t,"filterInput");var c;n._textFilter.addEventListener("keydown",function(){c&&clearTimeout(c),setTimeout(function(){return l()},300)}),n._ready=!0})},n.prototype.isLoggable=function(e){return'"'==e[0]&&'"'==e[e.length-1]||"'"==e[0]&&"'"==e[e.length-1]?!0:e.indexOf(".")>0?e.indexOf("(")>-1&&e.indexOf(")")>-1?!1:!0:!1},n.prototype.addDashboardEntries=function(e){for(var t=0,n=e.length;n>t;t++)this.addDashboardEntry(e[t])},n.prototype.addDashboardEntry=function(e){var t=new o(this._containerDiv,e);this._logEntries.push(t)},n.prototype.clearDashboard=function(){this._logEntries.splice(0,this._logEntries.length),this._containerDiv.innerHTML=""},n.prototype.applyFilter=function(e,t){t&&(t=t.toLowerCase());for(var n=0;n<this._logEntries.length;n++)if(e.length?-1===e.indexOf(this._logEntries[n].entry.type)?this._logEntries[n].element.classList.add("hide"):this._logEntries[n].element.classList.remove("hide"):this._logEntries[n].element.classList.remove("hide"),t&&!this._logEntries[n].element.classList.contains("hide")){for(var o=!1,i=0;i<this._logEntries[n].entry.messages.length;i++){var s=this._logEntries[n].entry.messages[i];if("string"!=typeof s&&(s=JSON.stringify(s).toLowerCase()),this._logEntries[n].entry.messages[i]&&-1!==s.indexOf(t)){o=!0;break}}o||this._logEntries[n].element.classList.add("hide")}console.log("apply filters "+JSON.stringify(e))},n}(e.DashboardPlugin);e.InteractiveConsoleDashboard=t,t.prototype.DashboardCommands={entries:function(e){var t=this;t.addDashboardEntries(e.entries)},clear:function(){var e=this;e.clearDashboard()},setorder:function(e){var t=this;t._interactiveInput.value='document.getElementById("'+e.order+'")'}};var n=function(){function t(t,n,o){var i=this;if(void 0===o&&(o=!1),this.contentRendered=!1,this.obj=n,this.element=new e.FluentDOM("DIV","object-description collapsed",t).element,o){var s=new e.FluentDOM("A","object-toggle obj-link",this.element),l=s.createChild("SPAN","toggle-state").text("+");s.createChild("SPAN","").html("[Object]"),s.click(function(){i.toggleView(),i.expanded()?l.text("-"):l.text("+")}),this.toggle=s.element}this.content=new e.FluentDOM("DIV","object-content",this.element).element}return t.prototype.expanded=function(){return!this.element.className.match("collapsed")},t.prototype.toggleView=function(){this.renderContent(),e.Tools.ToggleClass(this.element,"collapsed")},t.prototype.renderContent=function(){var n=this;this.obj&&!this.contentRendered&&(this.obj.proto&&(this.protoElt=new e.FluentDOM("DIV","obj-proto",this.content).append("A","label obj-link",function(e){var t=e.createChild("SPAN","toggle-state").text("+");e.createChild("SPAN","").html("[Prototype]"),e.click(function(){n.proto&&(n.proto.toggleView(),n.proto.expanded()?t.text("-"):t.text("+"))})}).element,this.proto=new t(this.protoElt,this.obj.proto)),this.obj.functions&&this.obj.functions.length&&(this.functionsElt=new e.FluentDOM("DIV","obj-functions collapsed",this.content).append("A","label obj-link",function(t){var o=t.createChild("SPAN","toggle-state").text("+");t.createChild("SPAN","").html("[Methods]"),t.click(function(){e.Tools.ToggleClass(n.functionsElt,"collapsed"),n.functionsElt.className.match("collapsed")?o.text("+"):o.text("-")})}).append("DIV","content collapsed",function(e){e.element;for(var t=0,o=n.obj.functions.length;o>t;t++)e.append("DIV","func",function(e){e.text(n.obj.functions[t])})}).element),this.propertiesElt=new e.FluentDOM("DIV","obj-properties",this.content).append("DIV","content",function(e){for(var o=0,i=n.obj.properties.length;i>o;o++){var s=n.obj.properties[o];e.append("DIV","prop",function(e){if("object"==typeof s.val&&null!==s.val&&void 0!==s.val){var n=null;e.append("A","prop-name obj-link",function(e){var t=e.createChild("SPAN","toggle-state").text("+");e.createChild("SPAN","").html('<span class="prop-title">'+s.name+"</span>: <span>[Object]</span>"),e.click(function(){n&&(n.toggleView(),n.expanded()?t.text("-"):t.text("+"))})}).append("DIV","prop-obj",function(e){s.val||console.error("no value !",s),n=new t(e.element,s.val)})}else e.append("DIV","prop-name",function(e){e.createChild("SPAN","blank-state"),e.createChild("SPAN","prop-title").text(s.name),e.createChild("SPAN").text(": "),e.createChild("SPAN","prop-value").text(s.val)})})}}).element,this.contentRendered=!0)},t}(),o=function(){function e(e,t){this.objects=[],this.entry=t,this.element=document.createElement("div"),this.element.className="log-entry "+this.getTypeClass(),this.element.title="Message received at "+(new Date).toLocaleTimeString(),e.appendChild(this.element),this.element.scrollIntoView();for(var n=0,o=t.messages.length;o>n;n++)this.addMessage(t.messages[n])}return e.prototype.addMessage=function(e){if("string"==typeof e||"number"==typeof e){var t=document.createElement("DIV");t.className="log-message text-message",this.element.appendChild(t),t.textContent=e+""}else{var o=new n(this.element,e,!0);this.objects.push(o)}},e.prototype.getTypeClass=function(){switch(this.entry.type){case"log":return"logMessage";case"debug":return"logDebug";case"info":return"logInfo";case"warn":return"logWarning";case"error":return"logError";case"exception":return"logException";default:return"logMessage"}},e}();e.Core.RegisterDashboardPlugin(new t)}(VORLON||(VORLON={}));