var __extends=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},domTimelineOptions,domHistory,VORLON;!function(e){var t=function(e){function t(){e.call(this,"domtimeline"),this._ready=!0}return __extends(t,e),t.prototype.getID=function(){return"DOMTIMELINE"},t.prototype.refresh=function(){},t.prototype.startClientSide=function(){function e(e){return e.__dashboardData}function t(e){var t=a(e.target);if(e.addedNodes.length>0){var n=1==e.addedNodes.length?a(e.addedNodes[0]):e.addedNodes.length+" nodes";return{type:"added",description:"Inserted "+n+" into "+t,timestamp:e.timestamp,details:{"Added nodes":i(e.addedNodes),Target:t,Timestamp:Math.round(10*e.timestamp)/1e4+"s",Claim:e.claim,Stack:"`"+e.stack.split("\n").filter(function(e){return-1==e.indexOf("vorlon.max")}).join("\n")+"`"},rawData:{type:"childList",addedNodes:o.getPointerListFor(e.addedNodes),nextSibling:o.getPointerFor(e.nextSibling),target:o.getPointerFor(e.target)}}}if(e.removedNodes.length>0){var n=1==e.removedNodes.length?a(e.removedNodes[0]):e.removedNodes.length+" nodes";return{type:"removed",description:"Removed "+n+" from "+t,timestamp:e.timestamp,details:{"Removed nodes":i(e.addedNodes),Target:t,Timestamp:Math.round(10*e.timestamp)/1e4+"s",Claim:e.claim,Stack:"`"+e.stack.split("\n").filter(function(e){return-1==e.indexOf("vorlon.max")}).join("\n")+"`"},rawData:{type:"childList",removedNodes:o.getPointerListFor(e.removedNodes),nextSibling:o.getPointerFor(e.nextSibling),target:o.getPointerFor(e.target)}}}if(e.attributeName)return null===e.newValue||void 0===e.newValue?{type:"modified",description:"Removed attribute `"+e.attributeName+"` from "+t,timestamp:e.timestamp,details:{"Attribute name":e.attributeName,"Old value":e.oldValue,"New value":e.newValue,Target:t,Timestamp:Math.round(10*e.timestamp)/1e4+"s",Claim:e.claim,Stack:"`"+e.stack.split("\n").filter(function(e){return-1==e.indexOf("vorlon.max")}).join("\n")+"`"},rawData:{type:"attributes",attributeName:e.attributeName,oldValue:e.oldValue,newValue:e.newValue,target:o.getPointerFor(e.target)}}:null===e.oldValue||void 0===e.oldValue?{type:"modified",description:"Added attribute `"+e.attributeName+"` to "+t,timestamp:e.timestamp,details:{"Attribute name":e.attributeName,"Old value":e.oldValue,"New value":e.newValue,Target:t,Timestamp:Math.round(10*e.timestamp)/1e4+"s",Claim:e.claim,Stack:"`"+e.stack.split("\n").filter(function(e){return-1==e.indexOf("vorlon.max")}).join("\n")+"`"},rawData:{type:"attributes",attributeName:e.attributeName,oldValue:e.oldValue,newValue:e.newValue,target:o.getPointerFor(e.target)}}:{type:"modified",description:"Updated attribute `"+e.attributeName+"` of "+t,timestamp:e.timestamp,details:{"Attribute name":e.attributeName,"Old value":e.oldValue,"New value":e.newValue,Target:t,Timestamp:Math.round(10*e.timestamp)/1e4+"s",Claim:e.claim,Stack:"`"+e.stack.split("\n").filter(function(e){return-1==e.indexOf("vorlon.max")}).join("\n")+"`"},rawData:{type:"attributes",attributeName:e.attributeName,oldValue:e.oldValue,newValue:e.newValue,target:o.getPointerFor(e.target)}};var n=a(e.target.parentNode);return{type:"modified",description:"Updated text content of "+n,timestamp:e.timestamp,details:{"Old value":e.oldValue,"New value":e.newValue,Timestamp:Math.round(10*e.timestamp)/1e4+"s",Claim:e.claim,Stack:"`"+e.stack.split("\n").filter(function(e){return-1==e.indexOf("vorlon.max")}).join("\n")+"`"},rawData:{type:"characterData",oldValue:e.oldValue,newValue:e.newValue,target:o.getPointerFor(e.target)}}}function a(e){return e instanceof HTMLElement?e.firstChild?(e=e.cloneNode(!1),e.appendChild(document.createTextNode("…")),"`"+e.outerHTML+"`"):"`"+e.outerHTML+"`":e instanceof SVGElement?"`<"+e.tagName+"…>`":"#"!=e.nodeName[0]?"`attribute "+e.nodeName+"`":e.nodeValue.length<15?"`"+e.nodeValue+"`":"`"+e.nodeValue.substr(0,15)+"…`"}function i(e){if(0==e.length)return"`empty node list`";if(1==e.length)return"`1 node: "+a(e[0]).replace(/^`|`$/g,"")+"`";for(var t="`"+e.length+" nodes:",i=0;i<e.length;i++)t+="\n"+a(e[i]).replace(/^`|`$/g,"");return t+"`"}var o=null;domTimelineOptions.onRecordingStart=function(){o=MappingSystem.NodeMappingSystem.initFromDocument(),window.domData=o},domTimelineOptions.considerLoggingRecords=function(e,a){function i(e){if(e.addedNodes&&e.addedNodes.length)for(var t=0;t<e.addedNodes.length;t++){var a=e.addedNodes[t];o.addNodeAndChildren(a)}}if(!o)return console.warn("domData not yet initalized; entries ignored: ",a);for(var n=a.length;n--;){var r=a[n];i(r),r.__dashboardData=t(r)}},domHistory.generateDashboardData=function(t){var a={};return a.url=location.href,a.title=document.title,a.isRecordingNow=domHistory.isRecording,a.isRecordingEnded=domHistory.isRecordingStopped,a.isPageFrozen=domHistory.future.length>0,a.pastEventsCount=domHistory.past.length,a.futureEventsCount=domHistory.future.length,a.assumedKnownData=t,a.history=[].concat(domHistory.past.map(e)).concat(domHistory.future.map(e)),a.history.splice(0,0|t.history),a.lostFuture=domHistory.lostFuture.map(e),a.lostFuture.splice(0,0|t.lostFuture),a.domData=o?o.data.slice(0|t.domData):[],a},sessionStorage.domTimelineOptions_startRecordingImmediately&&(sessionStorage.domTimelineOptions_startRecordingImmediately=!1,domHistory.startRecording())},t.prototype.onRealtimeMessageReceivedFromDashboardSide=function(e){var t;try{t=window.eval(e.message)}catch(a){t=a.stack}this.sendToDashboard({message:t,messageId:e.messageId})},t}(e.ClientPlugin);e.DOMTimelineClient=t,e.Core.RegisterClientPlugin(new t)}(VORLON||(VORLON={}));