var VORLON;!function(T){!function(T){T[T.SPOT_MESH=0]="SPOT_MESH",T[T.UNSPOT_MESH=1]="UNSPOT_MESH",T[T.START_ANIM=2]="START_ANIM",T[T.PAUSE_ANIM=3]="PAUSE_ANIM",T[T.UNPAUSE_ANIM=4]="UNPAUSE_ANIM",T[T.STOP_ANIM=5]="STOP_ANIM",T[T.TURN_ON_LIGHT=6]="TURN_ON_LIGHT",T[T.TURN_OFF_LIGHT=7]="TURN_OFF_LIGHT",T[T.HIDE_MESH=8]="HIDE_MESH",T[T.DISPLAY_MESH=9]="DISPLAY_MESH",T[T.DISPLAY_MESH_GIZMO=10]="DISPLAY_MESH_GIZMO",T[T.HIDE_MESH_GIZMO=11]="HIDE_MESH_GIZMO"}(T.QueryTypes||(T.QueryTypes={}));T.QueryTypes;!function(T){T[T.MESH=0]="MESH",T[T.MATERIAL=1]="MATERIAL",T[T.CAMERA=2]="CAMERA",T[T.LIGHT=3]="LIGHT",T[T.SKELETTON=4]="SKELETTON"}(T.AnimTargetTypes||(T.AnimTargetTypes={}));T.AnimTargetTypes}(VORLON||(VORLON={}));
var __extends=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},VORLON;!function(e){var t=function(){function e(e,t){this._prepend=function(e,t){e.insertBefore(t,e.firstChild)},this.dashboard=e,this.children=[],this.wrapper=document.createElement("div"),this.wrapper.className="tree-node tree-node-hidden tree-node-folded",this.content=document.createElement("div"),this.content.className="tree-node-content",this.content.innerHTML=t,this.wrapper.appendChild(this.content),this.features=document.createElement("div"),this.features.className="tree-node-features",this.wrapper.appendChild(this.features),this.hasChildren=!1,this.isFolded=!0,this.isHidden=!0}return e.prototype.addChild=function(e){this.hasChildren||(this.hasChildren=!0,this.createDropdownIcon(),this._prepend(this.wrapper,this.dropDownButton),this.wrapper.className+=" tree-node-with-children"),this.wrapper.appendChild(e.wrapper),this.children.push(e),e.parent=this},e.prototype.addFeature=function(e){this.features.appendChild(e)},e.prototype.createDropdownIcon=function(){var e=this,t=document.createElement("div");t.innerHTML="+",t.className="tree-node-button folded-button",t.addEventListener("click",function(){e.isFolded?(t.innerHTML="-",e.unfold()):(t.innerHTML="+",e.fold())}),this.dropDownButton=t},e.prototype.fold=function(){if(!this.isFolded){this.wrapper.className+=" tree-node-folded",this.isFolded=!0;for(var e=0;e<this.children.length;++e){var t=this.children[e];t.hide()}}},e.prototype.hide=function(){this.isHidden||(this.isHidden=!0,this.wrapper.className+=" tree-node-hidden")},e.prototype.unhide=function(){this.isHidden&&(this.isHidden=!1,this.wrapper.classList.remove("tree-node-hidden"))},e.prototype.unfold=function(){if(this.isFolded){this.wrapper.classList.remove("tree-node-folded"),this.isFolded=!1;for(var e=0;e<this.children.length;++e){var t=this.children[e];t.unhide()}}},e}(),a=function(e){function t(t,a,n){e.call(this,t,a),this.type=n,this.createAndAddTypeIcon(this.type)}return __extends(t,e),t.prototype.createAndAddTypeIcon=function(e){var t=document.createElement("div");t.className="tree-node-type-icon tree-node-type-icon-"+e,this.icon=t,this._prepend(this.wrapper,this.icon)},t}(t),n=function(e){function t(t,a,n){e.call(this,t,"<span>"+a+" : </span>"+n)}return __extends(t,e),t}(t),i=function(e){function t(t,a,n){e.call(this,t,a,n);var i=this._createColorSample(n);this.addFeature(i)}return __extends(t,e),t.prototype._createColorSample=function(e){var t=document.createElement("div");return t.className="tree-node-color-sample",e&&(t.style.backgroundColor=e,t.style.borderColor=this._isClearColor(e)?"#000000":"#ffffff"),t},t.prototype._isClearColor=function(e){return!("f"!=e.charAt(1)&&"F"!=e.charAt(1)||"f"!=e.charAt(3)&&"F"!=e.charAt(3)||"f"!=e.charAt(5)&&"F"!=e.charAt(5))},t}(n),s=function(e){function t(t,a,n){e.call(this,t,"url",a),this.completeURL=n,this.imageDisplayed=!1;var i=this._createImageViewer();this.addFeature(i)}return __extends(t,e),t.prototype._createImageViewer=function(){var e=this,t=document.createElement("div");t.className="tree-node-texture-thumbnail",t.style.backgroundImage="url("+this.completeURL+")";var a=document.createElement("div");return a.className="tree-node-texture-view",a.style.backgroundImage="url("+this.completeURL+")",t.addEventListener("mouseover",function(){e.imageDisplayed||(e.imageDisplayed=!0,e.dashboard.displayer.innerHTML="",e.dashboard.displayer.style.display="block",e.dashboard.displayer.appendChild(a))}),t.addEventListener("mouseout",function(){e.imageDisplayed&&(e.imageDisplayed=!1,e.dashboard.displayer.style.display="none",e.dashboard.displayer.innerHTML="")}),t},t}(n),r=function(t){function a(e,a,n){t.call(this,e,a),this.lightName=a,this.lightIsOn=n;var i=this._createSwitch();this.addFeature(i)}return __extends(a,t),a.prototype._createSwitch=function(){var t=this,a=document.createElement("div");return a.className="tree-node-light-switch clickable",this.lightIsOn?(a.innerHTML="ON",a.className+=" tree-node-light-switch-on"):(a.innerHTML="OFF",a.className+=" tree-node-light-switch-off"),a.addEventListener("click",function(){var n={lightName:t.lightName,sceneID:t.parent.parent.sceneID};t.lightIsOn?(t.lightIsOn=!1,a.innerHTML="OFF",a.classList.remove("tree-node-light-switch-on"),a.className+=" tree-node-light-switch-off",t.dashboard.queryToClient(e.QueryTypes.TURN_OFF_LIGHT,n)):(t.lightIsOn=!0,a.innerHTML="ON",a.classList.remove("tree-node-light-switch-off"),a.className+=" tree-node-light-switch-on",t.dashboard.queryToClient(e.QueryTypes.TURN_ON_LIGHT,n))}),a},a}(t),o=function(e){function t(t,a){e.call(this,t,"Scene nÂ° "+a),this.sceneID=a}return __extends(t,e),t}(t),d=function(t){function a(e,a,n){t.call(this,e,a),this.meshName=a,this.meshIsSpotted=!1,this.meshIsVisible=n,this.gizmosVisible=!1;var i=this._createSpotMeshButton();this.addFeature(i);var s=this._createSwitch();this.addFeature(s);var r=this._createGizmoSwitch();this.addFeature(r)}return __extends(a,t),a.prototype._createSpotMeshButton=function(){var t=this,a=document.createElement("div");a.innerHTML="Spot mesh";var n=document.createElement("div");return n.className="tree-node-features-element tree-node-spot-mesh-button tree-node-spot-mesh-button-off clickable",n.addEventListener("click",function(){var a={meshName:t.meshName,sceneID:t.parent.parent.sceneID};t.meshIsSpotted?(t.meshIsSpotted=!1,n.classList.remove("tree-node-spot-mesh-button-on"),n.className+=" tree-node-spot-mesh-button-off",t.dashboard.queryToClient(e.QueryTypes.UNSPOT_MESH,a)):(t.meshIsSpotted=!0,n.classList.remove("tree-node-spot-mesh-button-off"),n.className+=" tree-node-spot-mesh-button-on",t.dashboard.queryToClient(e.QueryTypes.SPOT_MESH,a))}),a.appendChild(n),a},a.prototype._createSwitch=function(){var t=this,a=document.createElement("div");return a.className="tree-node-mesh-switch",this.meshIsVisible?(a.innerHTML="ON",a.className+="tree-node-features-element tree-node-mesh-switch-on clickable"):(a.innerHTML="OFF",a.className+=" tree-node-mesh-switch-off"),a.addEventListener("click",function(){var n={meshName:t.meshName,sceneID:t.parent.parent.sceneID};t.meshIsVisible?(t.meshIsVisible=!1,a.innerHTML="OFF",a.classList.remove("tree-node-mesh-switch-on"),a.className+=" tree-node-mesh-switch-off",t.dashboard.queryToClient(e.QueryTypes.HIDE_MESH,n)):(t.meshIsVisible=!0,a.innerHTML="ON",a.classList.remove("tree-node-mesh-switch-off"),a.className+=" tree-node-mesh-switch-on",t.dashboard.queryToClient(e.QueryTypes.DISPLAY_MESH,n))}),a},a.prototype._createGizmoSwitch=function(){var t=this,a=document.createElement("div");return a.className="tree-node-features-element tree-node-mesh-gizmo clickable",a.innerHTML="gizmo off",a.className+=" tree-node-mesh-gizmo-off",a.addEventListener("click",function(){var n={meshName:t.meshName,sceneID:t.parent.parent.sceneID};t.gizmosVisible?(t.gizmosVisible=!1,a.innerHTML="gizmo off",a.classList.remove("tree-node-mesh-gizmo-on"),a.className+=" tree-node-mesh-gizmo-off",t.dashboard.queryToClient(e.QueryTypes.HIDE_MESH_GIZMO,n)):(t.gizmosVisible=!0,a.innerHTML="gizmo on",a.classList.remove("tree-node-mesh-gizmo-off"),a.className+=" tree-node-mesh-gizmo-on",t.dashboard.queryToClient(e.QueryTypes.DISPLAY_MESH_GIZMO,n))}),a},a}(t),h=function(t){function a(e,a,n,i){t.call(this,e,a),this.animName=a,this.targetType=n,this.animationIsStopped=i,this.animationIsPaused=!1,this.animationIsStarted=!i}return __extends(a,t),a.prototype._createPlayStopIcons=function(){var e=this;this.playBtn=document.createElement("button"),this.stopBtn=document.createElement("button"),this.animationIsStarted?(this.playBtn.className="tree-node-features-element tree-node-animation-button tree-node-animation-button-pause",this.stopBtn.className="tree-node-features-element tree-node-animation-button tree-node-animation-button-stop"):(this.playBtn.className="tree-node-features-element tree-node-animation-button tree-node-animation-button-play",this.stopBtn.className="tree-node-features-element tree-node-animation-button tree-node-animation-button-stop-pressed"),this.playBtn.addEventListener("click",function(){e.animationIsStarted?e.animationIsPaused?e.unpauseAnimation():e._pauseAnimation():e._startAnimation()}),this.stopBtn.addEventListener("click",function(){e.animationIsStarted&&e._stopAnimation()}),this.addFeature(this.playBtn),this.addFeature(this.stopBtn)},a.prototype._startAnimation=function(){this.animationIsStopped&&(this.animationIsStarted=!0,this.animationIsStopped=!1,this.playBtn.classList.remove("tree-node-animation-button-play"),this.playBtn.className+=" tree-node-animation-button-pause",this.stopBtn.classList.remove("tree-node-animation-button-stop-pressed"),this.stopBtn.className+=" tree-node-animation-button-stop",this.dashboard.queryToClient(e.QueryTypes.START_ANIM,{animName:this.animName,animTargetType:this.targetType,animTargetName:this._getTargetName(),sceneID:this._getSceneID()}))},a.prototype._pauseAnimation=function(){this.animationIsPaused||this.animationIsStopped||(this.animationIsPaused=!0,this.playBtn.classList.remove("tree-node-animation-button-pause"),this.playBtn.className+=" tree-node-animation-button-play",this.dashboard.queryToClient(e.QueryTypes.PAUSE_ANIM,{animName:this.animName,animTargetType:this.targetType,animTargetName:this._getTargetName(),sceneID:this._getSceneID()}))},a.prototype.unpauseAnimation=function(){this.animationIsPaused&&(this.animationIsPaused=!1,this.playBtn.classList.remove("tree-node-animation-button-play"),this.playBtn.className+=" tree-node-animation-button-pause",this.dashboard.queryToClient(e.QueryTypes.UNPAUSE_ANIM,{animName:this.animName,animTargetType:this.targetType,animTargetName:this._getTargetName(),sceneID:this._getSceneID()}))},a.prototype._stopAnimation=function(){this.animationIsStarted&&(this.animationIsStarted=!1,this.animationIsStopped=!0,this.animationIsPaused=!1,this.playBtn.classList.remove("tree-node-animation-button-pause"),this.playBtn.className+=" tree-node-animation-button-play",this.stopBtn.classList.remove("tree-node-animation-button-stop"),this.stopBtn.className+=" tree-node-animation-button-stop-pressed",this.dashboard.queryToClient(e.QueryTypes.STOP_ANIM,{animName:this.animName,animTargetType:this.targetType,animTargetName:this._getTargetName(),sceneID:this._getSceneID()}))},a.prototype._getTargetName=function(){var t;switch(this.targetType){case e.AnimTargetTypes.MESH:t=this.parent.parent.meshName}return t},a.prototype._getSceneID=function(){var t;switch(this.targetType){case e.AnimTargetTypes.MESH:t=this.parent.parent.parent.parent.sceneID}return t},a}(t),l=function(){function l(e){this.dashboard=e}return l.prototype._generateMaterialNode=function(e,t){var a,r=new n(this.dashboard,"material","");if(a=new i(this.dashboard,"diffuseColor",e.diffuseColor),r.addChild(a),a=new i(this.dashboard,"ambientColor",e.ambientColor),r.addChild(a),a=new i(this.dashboard,"emissiveColor",e.emissiveColor),r.addChild(a),a=new i(this.dashboard,"specularColor",e.specularColor),r.addChild(a),e.diffuseTexture){a=new n(this.dashboard,"diffuseTexture",e.diffuseTexture.name);var o;o=new n(this.dashboard,"name",e.diffuseTexture.name),a.addChild(o),o=new s(this.dashboard,e.diffuseTexture.url,t+e.diffuseTexture.url),a.addChild(o),r.addChild(a)}return r},l.prototype._generateAnimationsNode=function(t){var a=this,i=new n(this.dashboard,"animations","");return t.forEach(function(t){var s=new h(a.dashboard,t.name,e.AnimTargetTypes.MESH,t.stopped),r=new n(a.dashboard,"name",t.name);s.addChild(r),r=new n(a.dashboard,"target property",t.targetProperty),s.addChild(r),r=new n(a.dashboard,"frame per second",t.framePerSecond),s.addChild(r),r=new n(a.dashboard,"running",t.stopped),s.addChild(r),r=new n(a.dashboard,"begin frame",t.beginFrame),s.addChild(r),r=new n(a.dashboard,"end frame",t.endFrame),s.addChild(r),i.addChild(s)}),i},l.prototype.generateMeshesTree=function(e,t){var i=this,s=new a(this.dashboard,"Meshes","mesh");return e.forEach(function(e){var a=new d(i.dashboard,e.name,e.isVisible),r=new n(i.dashboard,"name",e.name);if(a.addChild(r),r=new n(i.dashboard,"position","("+e.position.x+", "+e.position.y+", "+e.position.z+")"),a.addChild(r),r=new n(i.dashboard,"rotation","("+e.rotation.x+", "+e.rotation.y+", "+e.rotation.z+")"),a.addChild(r),r=new n(i.dashboard,"scaling","("+e.scaling.x+", "+e.scaling.y+", "+e.scaling.z+")"),a.addChild(r),r=new n(i.dashboard,"bounding box center","("+e.boundingBoxCenter.x+", "+e.boundingBoxCenter.y+", "+e.boundingBoxCenter.z+")"),a.addChild(r),e.animations&&(r=i._generateAnimationsNode(e.animations),a.addChild(r)),e.material&&(r=i._generateMaterialNode(e.material,t),a.addChild(r)),e.multiMaterial){r=new n(i.dashboard,"multi material","");var o;e.multiMaterial.subMaterials.forEach(function(e){o=i._generateMaterialNode(e,t),r.addChild(o)}),a.addChild(r)}s.addChild(a)}),s},l.prototype.generateTexturesTree=function(e,a){var i=this,r=new t(this.dashboard,"Textures");return e.forEach(function(e){var o=new t(i.dashboard,e.name),d=new n(i.dashboard,"name",e.name);o.addChild(d),d=new s(i.dashboard,e.url,a+e.url),o.addChild(d),r.addChild(o)}),r},l.prototype.generateActiveCameraNode=function(e){var t,i=new a(this.dashboard,"Active camera","camera");return t=new n(this.dashboard,"name",e.name),i.addChild(t),t=new n(this.dashboard,"type",e.type),i.addChild(t),t=new n(this.dashboard,"mode",e.mode),i.addChild(t),t=new n(this.dashboard,"layer mask",e.layerMask),i.addChild(t),t=new n(this.dashboard,"position","("+e.position.x+", "+e.position.y+", "+e.position.z+")"),i.addChild(t),"FreeCamera"==e.type&&(t=new n(this.dashboard,"speed",e.speed),i.addChild(t),t=new n(this.dashboard,"rotation","("+e.rotation.x+", "+e.rotation.y+", "+e.rotation.z+")"),i.addChild(t)),"ArcRotateCamera"==e.type&&(t=new n(this.dashboard,"alpha",e.alpha),i.addChild(t),t=new n(this.dashboard,"beta",e.beta),i.addChild(t),t=new n(this.dashboard,"radius",e.radius),i.addChild(t)),e.animations&&(t=this._generateAnimationsNode(e.animations),i.addChild(t)),i},l.prototype.generateCamerasTree=function(e){var i=this,s=new a(this.dashboard,"Cameras","camera");return e.forEach(function(e){var a,r=new t(i.dashboard,e.name);a=new n(i.dashboard,"name",e.name),r.addChild(a),a=new n(i.dashboard,"type",e.type),r.addChild(a),a=new n(i.dashboard,"mode",e.mode),r.addChild(a),a=new n(i.dashboard,"layer mask",e.layerMask),r.addChild(a),a=new n(i.dashboard,"position","("+e.position.x+", "+e.position.y+", "+e.position.z+")"),r.addChild(a),"FreeCamera"==e.type&&(a=new n(i.dashboard,"speed",e.speed),r.addChild(a),a=new n(i.dashboard,"rotation","("+e.rotation.x+", "+e.rotation.y+", "+e.rotation.z+")"),r.addChild(a)),"ArcRotateCamera"==e.type&&(a=new n(i.dashboard,"alpha",e.alpha),r.addChild(a),a=new n(i.dashboard,"beta",e.beta),r.addChild(a),a=new n(i.dashboard,"radius",e.radius),r.addChild(a)),e.animations&&(a=i._generateAnimationsNode(e.animations),r.addChild(a)),s.addChild(r)}),s},l.prototype.generateLightsTree=function(e){var t=this,s=new a(this.dashboard,"Lights","light");return e.forEach(function(e){var a=new r(t.dashboard,e.name,e.isEnabled),o=new n(t.dashboard,"name",e.name);a.addChild(o),o=new n(t.dashboard,"type",e.type),a.addChild(o),"HemisphericLight"!=e.type&&(o=new n(t.dashboard,"position","("+e.position.x+", "+e.position.y+", "+e.position.z+")"),a.addChild(o)),o=new i(t.dashboard,"diffuse",e.diffuse),a.addChild(o),o=new i(t.dashboard,"specular",e.specular),a.addChild(o),o=new n(t.dashboard,"intensity",e.intensity),a.addChild(o),"HemisphericLight"==e.type&&(o=new n(t.dashboard,"direction","("+e.direction.x+", "+e.direction.y+", "+e.direction.z+")"),a.addChild(o),o=new i(t.dashboard,"groundColor",e.groundColor),a.addChild(o)),s.addChild(a)}),s},l.prototype.generateBeforeRenderCallbacksTree=function(e){var a=this,i=new t(this.dashboard,"functions registered before render");return e.forEach(function(e,s){var r=new t(a.dashboard,s),o=new n(a.dashboard,"body",e.body);r.addChild(o),i.addChild(r)}),i},l.prototype.generateAfterRenderCallbacksTree=function(e){var a=this,i=new t(this.dashboard,"functions registered after render");return e.forEach(function(e,s){var r=new t(a.dashboard,s),o=new n(a.dashboard,"body",e.body);r.addChild(o),i.addChild(r)}),i},l.prototype.generateScenesTree=function(e,a){var n=this,i=new t(this.dashboard,"Scenes explorer");return e.forEach(function(e,t){var s=new o(n.dashboard,t);if(e.activeCameraData){var r=n.generateActiveCameraNode(e.activeCameraData);s.addChild(r)}if(e.meshesData){var d=n.generateMeshesTree(e.meshesData,a);s.addChild(d)}if(e.texturesData){var h=n.generateTexturesTree(e.texturesData,a);s.addChild(h)}if(e.camerasData){var l=n.generateCamerasTree(e.camerasData);s.addChild(l)}if(e.lightsData){var c=n.generateLightsTree(e.lightsData);s.addChild(c)}if(e.beforeRenderCallbacksData){var m=n.generateBeforeRenderCallbacksTree(e.beforeRenderCallbacksData);s.addChild(m)}if(e.afterRenderCallbacksData){var p=n.generateAfterRenderCallbacksTree(e.afterRenderCallbacksData);s.addChild(p)}i.addChild(s)}),i},l}(),c=function(e){function t(){e.call(this,"babylonInspector","control.html","control.css"),this._ready=!1,this.id="BABYLONINSPECTOR",this._dataTreeGenerator=new l(this),this.treeRoot=null}return __extends(t,e),t.prototype.getID=function(){return this.id},t.prototype.onRealtimeMessageReceivedFromClientSide=function(e){switch(e.messageType){case"SCENES_DATA":var t=e.data;this._refreshTree(t,e.clientURL)}},t.prototype.queryToClient=function(e,t){var a={queryType:e,data:t};this.sendToClient(a)},t.prototype.startDashboardSide=function(e){var t=this;void 0===e&&(e=null),this._insertHtmlContentAsync(e,function(e){t._containerDiv=e,t.displayer=t._containerDiv.querySelector("#babylonInspector-displayer"),t._ready=!0})},t.prototype._refreshTree=function(e,t){this.treeRoot=this._dataTreeGenerator.generateScenesTree(e,t),this.treeRoot.unhide(),this.treeRoot.unfold(),this._containerDiv.appendChild(this.treeRoot.wrapper)},t}(e.DashboardPlugin);e.BabylonInspectorDashboard=c,e.Core.RegisterDashboardPlugin(new c)}(VORLON||(VORLON={}));