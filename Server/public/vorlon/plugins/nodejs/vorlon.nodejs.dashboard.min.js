var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},VORLON;!function(t){var e=function(t){function e(){t.call(this,"nodejs","control.html",["control.css","tree.css"],["chart.js","chart-legend.js"]),this._ready=!0,this.__MEGA_BYTE=1048576,console.log("Started")}return __extends(e,t),e.prototype.getID=function(){return"NODEJS"},e.prototype.startDashboardSide=function(t){var e=this;void 0===t&&(t=null),this._insertHtmlContentAsync(t,function(){var t=e;e.toogleMenu(),e._time=5,e._chart=!1,e._chart_data={labels:[0],series:[[0],[0],[0]]},e._set_chart=setInterval(function(){t.chart()},500),e.__html=[],e.sendToClient("infos"),e.sendToClient("memory"),e.sendToClient("modules")})},e.prototype.chart=function(){"object"==typeof Chartist&&(this._chart=!0,clearInterval(this._set_chart),console.log("stating chart"),new Chartist.Line("#memory-chart",this._chart_data,{plugins:[Chartist.plugins.legend({legendNames:["HEAP Used","HEAP Total","RSS"]})],fullWidth:!0,chartPadding:{right:40},axisY:{labelInterpolationFnc:function(t){return t+"MB"}}}))},e.prototype.jstree=function(){$(".tree li").each(function(){$(this).find("ul").children("li").length>0&&$(this).addClass("parent")}),$(".tree li.parent > a").click(function(){$(this).parent().toggleClass("active"),$(this).parent().children("ul").slideToggle("fast")})},e.prototype.toogleMenu=function(){$(".plugin-nodejs .open-menu").click(function(){$(".plugin-nodejs .open-menu").removeClass("active-menu"),$(".plugin-nodejs #searchlist").val(""),$(".plugin-nodejs .explorer-menu").hide(),$(".plugin-nodejs #"+$(this).data("menu")).show(),$(".plugin-nodejs .new-entry").fadeOut(),$(this).addClass("active-menu")})},e.prototype.renderTree=function(t){var e=this;e.__html.push("<ul>"),$.each(t,function(t,i){e.__html.push("<li><a>"+i.text+"</a>"),i.children&&e.renderTree(i.children),e.__html.push("</li>")}),e.__html.push("</ul>")},e.prototype.buildTree=function(t,e){if(0!==t.length){for(var i=0;i<e.length;i++)if(t[0]==e[i].text)return this.buildTree(t.splice(1,t.length),e[i].children),void 0;var s={text:t[0],children:[]};e.push(s),this.buildTree(t.splice(1,t.length),s.children)}},e.prototype.onRealtimeMessageReceivedFromClientSide=function(t){if("modules"==t.type){for(var e=t.data,i=[],s=0;s<e.length;s++){e[s]=e[s].split("\\");for(var n=0;n<e[s].length;n++)if("node_modules"==e[s][n]){e[s].splice(0,n);break}this.buildTree(e[s],i)}this.renderTree(i),$("#jstree").append(this.__html.join("")),this.jstree()}if("infos"==t.type){for(var a in t.data)$(".infos-"+a).append(t.data[a]);var r="";switch(t.data.platform){case"linux":r="linux.png";break;case"win32":r="windows.png";break;case"win64":r="windows.png";break;case"darwin":r="apple.png"}$(".infos-platform img").attr("src","/images/systems/"+r)}if("memory"==t.type){if(!this._chart)return;this._time>=70&&(this._chart_data.series[0].splice(0,1),this._chart_data.series[1].splice(0,1),this._chart_data.series[2].splice(0,1),this._chart_data.labels.splice(0,1)),this._chart_data.labels.push(this._time),this._chart_data.series[0].push(t.data.heapUsed/this.__MEGA_BYTE),this._chart_data.series[1].push(t.data.heapTotal/this.__MEGA_BYTE),this._chart_data.series[2].push(t.data.rss/this.__MEGA_BYTE),this.chart(),this._time+=5}},e}(t.DashboardPlugin);t.NodejsDashboard=e,t.Core.RegisterDashboardPlugin(new e)}(VORLON||(VORLON={}));