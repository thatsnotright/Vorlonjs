var VORLON;!function(t){var n=function(){function n(t,n,e){var i=this;this.dashboardPlugin=t,this.treeCategory=n,this.functionName=e,this.fullpathName=n+"."+e,this.elements=[],this.sendToClient=function(){return i.dashboardPlugin.sendToClient({type:"function",name:i.fullpathName,args:i.getArgs(),hasAsyncResult:i.isAsync()})}}return n.prototype.addTree=function(){var n=this,e=t.OfficeTools.AddTreeFunction(this.treeCategory,this.functionName);e.click(function(){t.OfficeTools.ShowFunction(n.fullpathName,n.sendToClient,n.elements)})},n.prototype.getArgs=function(){var t=[];return this.elements.forEach(function(n){null!==n.value&&void 0!==n.value&&""!==n.value&&t.push(n.value)}),t},n.prototype.isAsync=function(){var t=this.functionName.toLowerCase().indexOf("async")>0;return t},n}();t.OfficeFunction=n}(VORLON||(VORLON={}));
var $,VORLON;!function(e){var t=function(){function t(){}return t.IsOutlook=function(){var e="window.Office.context.mailbox";return null!==document.getElementById(e)&&void 0!==document.getElementById(e)},t.AddTreeFunction=function(t,n){if(null!==document.getElementById(t)&&void 0!==document.getElementById(t)){var o=document.getElementById(t).querySelector(".expand-content"),r=new e.FluentDOM("DIV","obj-func",o),i=r.createChild("SPAN","func-name").text(n);return i}},t._ClearPropertiesAndResults=function(){var e=document.querySelector("#office-properties");if(void 0!==e&&null!==e)for(;e.hasChildNodes();)e.removeChild(e.lastChild)},t.GetOfficeType=function(e){return"Outlook"==e?{officeType:"Outlook",version:"",background:"#0173C7"}:e.wordapi?{officeType:"Word",version:e.wordapi,background:"#2A579A"}:e.excelapi?{officeType:"Excel",version:e.excelapi,background:"#227447"}:e.excelapi||e.wordapi?e.project?{officeType:"Project",version:e.projectapi,background:"#2E7237"}:{officeType:"Office",version:"1.0",background:"#0173C7"}:{officeType:"PowerPoint",version:e.pdf,background:"#B7472A"}},t.ShowFunctionResult=function(e){void 0!==e.value&&null!==e.value&&(e.value=JSON.parse(e.value));var n=JSON.stringify(e.value,void 0,4),o=document.querySelector("#office-properties"),r=document.querySelector("#office-results-values");if(void 0!==r&&null!==r)for(;r.hasChildNodes();)r.removeChild(r.lastChild);else r=document.createElement("DIV"),r.className="office-results-values",r.id="office-results-values",o.appendChild(r);var i=document.createElement("pre");i.className="results",i.innerHTML=t.FormatJson(n),r.appendChild(i)},t.FormatJson=function(e){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})},t.ShowFunction=function(t,n,o){e.OfficeTools._ClearPropertiesAndResults();var r=document.querySelector("#office-properties"),i=document.querySelector("#office-properties-title");i.innerHTML="Function";var a=new e.FluentDOM("DIV","office-properties-values",r);if(a.append("div","fullpath",function(e){e.createChild("SPAN","function-name").text("Function"),e.createChild("SPAN","function-value").text(t)}),void 0!==o&&o.length>0)for(var l in o){var u=o[l];a.append("div","options",function(e){e.createChild("SPAN","function-name").text(u.attributes.getNamedItem("tag").value),e.element.appendChild(u)})}a.append("div","invoker",function(o){var r=new e.FluentDOM("INPUT","function-invoker",o.element);r.attr("type","button"),r.attr("value","invoke"),r.attr("id",t),r.click(n)})},t.ShowProperty=function(t){e.OfficeTools._ClearPropertiesAndResults();var n=document.querySelector("#office-properties"),o=document.querySelector("#office-properties-title");o.innerHTML="Property";var r=new e.FluentDOM("DIV","office-properties-values",n);r.append("div","prop-fullpath",function(e){e.createChild("SPAN","name").text("Name"),e.createChild("SPAN","value").text(t.fullpath)}),r.append("div","prop-name",function(e){e.createChild("SPAN","name").text("Type"),e.createChild("SPAN","value").text(t.type)}),r.append("div","prop-type",function(e){e.createChild("SPAN","name").text("Value"),e.createChild("SPAN","value").text(t.value)})},t.AddZone=function(t,n){if(null!==document.getElementById(t)&&void 0!==document.getElementById(t)&&(null===document.getElementById(t+"."+n)||void 0===document.getElementById(t+"."+n))){var o=document.getElementById(t).children[1],r=new e.FluentDOM("DIV","objdescriptor",o);r.append("DIV","expandable expanded",function(o){var r;o.attr("id",t+"."+n),o.append("DIV","expand",function(t){r=t.createChild("SPAN","expand-btn").text("-"),r.click(function(t){t.stopPropagation(),e.Tools.ToggleClass(o.element,"expanded",function(e){e?r.text("-"):r.text("+")})}),t.createChild("SPAN","expand-label").text(n)}),o.append("DIV","expand-content",function(){})})}},t.CreateTextArea=function(e,t,n){var o=document.createElement("textarea");return o.setAttribute("rows","4"),o.setAttribute("cols","40"),o.setAttribute("name",e),o.setAttribute("id",e),n&&(o.value=n),o.setAttribute("tag",t+": "),o},t.CreateTextBlock=function(e,t,n){var o=document.createElement("input");return o.setAttribute("type","text"),o.setAttribute("name",e+".coercionType"),o.setAttribute("id",e+".coercionType "),void 0!==n&&(o.value=n),o.setAttribute("tag",t+" : "),o},t}();e.OfficeTools=t}(VORLON||(VORLON={}));
var $,VORLON;!function(e){var t=function(){function t(t){var n=this;this.apis=[function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.requirements","isSetSupported"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".apiName","Api name"),a=e.OfficeTools.CreateTextBlock(t.fullpathName+".apiVersion","Api Version");return t.elements.push(o,a),t},function(){return new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","getAllAsync")},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","getSelectedDataAsync"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".coercionType","Coercion type","text"),a=e.OfficeTools.CreateTextBlock(t.fullpathName+".filterType","Filter type","all"),l=e.OfficeTools.CreateTextBlock(t.fullpathName+".valueFormat","Value format","unformatted");return t.elements.push(o,a,l),t.getArgs=function(){var e=[o.value,{filterType:""===a.value?null:a.value,valueFormat:""===l.value?null:l.value}];return e},t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","getFileAsync");return t.elements.push(e.OfficeTools.CreateTextBlock(t.fullpathName+".fileType","Type","text")),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","setSelectedDataAsync"),o=e.OfficeTools.CreateTextArea(t.fullpathName+".data","Data","Hello World"),a=e.OfficeTools.CreateTextBlock(t.fullpathName+".coerctionType","Type","text");return t.elements.push(o,a),t.getArgs=function(){var e=[o.value,{coercionType:""===a.value?null:a.value}];return e},t}],this.dashboardPlugin=t}return t.prototype.execute=function(){this.apis.forEach(function(e){e().addTree()})},t}();e.OfficeDocument=t}(VORLON||(VORLON={}));
var $,VORLON;!function(e){var t=function(){function t(t){var n=this;this.apis=[function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getSelectedDataAsync");return t.elements=[e.OfficeTools.CreateTextBlock(t.fullpathName+".coerciontyp","Coercion type","text")],t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","setSelectedDataAsync"),i=e.OfficeTools.CreateTextArea(t.fullpathName+".data","Data","Hello World"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".coerctionType","Type","text");return t.elements.push(i,o),t.getArgs=function(){var e=[i.value,{coercionType:""===o.value?null:o.value}];return e},t},function(){return new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getRegExMatches")},function(){return new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getUserIdentityTokenAsync")},function(){return new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getCallbackTokenAsync")},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getRegExMatchesByName"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".getRegExMatchesByName","Time value",Date.now().toString());return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","displayReplyAllForm"),i=JSON.stringify({htmlBody:"hi"}),o=e.OfficeTools.CreateTextArea(t.fullpathName+".formData","Xml value :",i);return t.elements.push(o),t.getArgs=function(){var e=[{value:o.value,type:"Json"}];return e},t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox","makeEwsRequestAsync"),i=e.OfficeTools.CreateTextArea(t.fullpathName+".xmlValue","Xml value :",'<?xml version="1.0" encoding="utf-8"?>');return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox","convertToLocalClientTime"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".timeValue","Time value :",Date.now().toString());return t.elements.push(i),t.getArgs=function(){var e=[{value:i.value,type:"Datetime"}];return e},t},function(){return new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getEntities")},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.body","setSelectedDataAsync"),i=e.OfficeTools.CreateTextArea(t.fullpathName+".formData","Data"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".getAsync","Coercion type","text");return t.elements.push(i,o),t.getArgs=function(){var e=[i.value,{coercionType:o.value}];return e},t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.body","setAsync"),i=e.OfficeTools.CreateTextArea(t.fullpathName+".formData","Data"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".formData","Coercion type","text");return t.elements.push(i,o),t.getArgs=function(){var e=[i.value,{coercionType:o.value}];return e},t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.body","prependAsync"),i=e.OfficeTools.CreateTextArea(t.fullpathName+".formData","Data"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".formData","Coercion type","text");return t.elements.push(i,o),t.getArgs=function(){var e=[i.value,{coercionType:o.value}];return e},t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.body","getTypeAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.body","getAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".getAsync","Coercion type","text");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getEntitiesByType"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".entityType","Office.MailboxEnums.EntityType");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","getFilteredEntitiesByName"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".getFilteredEntitiesByName","Entity name");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","saveAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","addFileAttachmentAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".uri","Uri"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".apiVersion","Attachment name");return t.elements.push(i,o),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item","removeAttachmentAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".removeAttachmentAsync","id");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.notificationMessages","getAllAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.notificationMessages","addAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".notificationMessages.addAsync.key","key"),o=JSON.stringify({type:"progressIndicator",message:"Processing the message ..."}),a=e.OfficeTools.CreateTextArea(t.fullpathName+".notificationMessages.addAsync.json","JSON message",o);return t.getArgs=function(){var e=[i.value,{value:a.value,type:"Json"}];return e},t.elements.push(i,a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.notificationMessages","removeAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+"notificationMessages.removeAsync","key");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.notificationMessages","replaceAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName+".notificationMessages.replaceAsync.key","key"),o=JSON.stringify({type:"informationalMessage",message:"The message was processed successfuly",icon:"iconid",persistent:!1}),a=e.OfficeTools.CreateTextArea(t.fullpathName+".notificationMessages.replaceAsync.json","JSON message",o);return t.getArgs=function(){var e=[i.value,{value:a.value,type:"Json"}];return e},t.elements.push(i,a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.to","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.to","addAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.to","setAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.cc","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.cc","addAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.cc","setAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.bcc","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.bcc","addAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.bcc","setAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.requiredAttendees","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.requiredAttendees","addAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.requiredAttendees","setAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.optionalAttendees","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.optionalAttendees","addAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.optionalAttendees","setAsync"),i=[{displayName:"Allie Bellew",emailAddress:"allieb@contoso.com"},{displayName:"Alex Darrow",emailAddress:"alexd@contoso.com"}],o=JSON.stringify(i),a=e.OfficeTools.CreateTextArea(t.fullpathName,"Recipients",o);return t.getArgs=function(){var e=[{value:a.value,type:"Json"}];return e},t.elements.push(a),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.roamingSettings","get"),i=e.OfficeTools.CreateTextBlock(t.fullpathName,"key");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.roamingSettings","remove"),i=e.OfficeTools.CreateTextBlock(t.fullpathName,"key");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.roamingSettings","set"),i=e.OfficeTools.CreateTextBlock(t.fullpathName,"key"),o=e.OfficeTools.CreateTextBlock(t.fullpathName,"value");return t.elements.push(i,o),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.roamingSettings","saveAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.subject","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.subject","setAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName,"Subject");return t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.start","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.start","setAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName,"UTC Datetime");return t.getArgs=function(){var e=[{value:i.value,type:"Datetime"}];return e},t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.end","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.end","setAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName,"UTC Datetime");return t.getArgs=function(){var e=[{value:i.value,type:"Datetime"}];return e},t.elements.push(i),t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.location","getAsync");return t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.mailbox.item.location","setAsync"),i=e.OfficeTools.CreateTextBlock(t.fullpathName,"Location");return t.elements.push(i),t}],this.dashboardPlugin=t}return t.prototype.execute=function(){e.OfficeTools.AddZone("window.Office.context.mailbox.item","to"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","bcc"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","cc"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","optionalAttendees"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","requiredAttendees"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","subject"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","body"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","start"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","end"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","location"),e.OfficeTools.AddZone("window.Office.context.mailbox.item","notificationMessages"),e.OfficeTools.AddZone("window.Office.context","roamingSettings"),this.apis.forEach(function(e){e().addTree()})},t}();e.OfficeOutlook=t}(VORLON||(VORLON={}));
var $,VORLON;!function(e){var t=function(){function t(t){var n=this;this.apis=[function(){return new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","getActiveViewAsync")},function(){return new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","getFilePropertiesAsync")},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","getSelectedDataAsync"),o=e.OfficeTools.CreateTextBlock(t.fullpathName+".coercionType","Coercion type","text"),a=e.OfficeTools.CreateTextBlock(t.fullpathName+".filterType","Filter type","all"),c=e.OfficeTools.CreateTextBlock(t.fullpathName+".valueFormat","Value format","unformatted");return t.elements.push(o,a,c),t.getArgs=function(){var e=[o.value,{filterType:""===a.value?null:a.value,valueFormat:""===c.value?null:c.value}];return e},t},function(){var t=new e.OfficeFunction(n.dashboardPlugin,"window.Office.context.document","setSelectedDataAsync"),o=e.OfficeTools.CreateTextArea(t.fullpathName+".data","Data","Hello World"),a=e.OfficeTools.CreateTextBlock(t.fullpathName+".coerctionType","Type","text");return t.elements.push(o,a),t.getArgs=function(){var e=[o.value,{coercionType:""===a.value?null:a.value}];return e},t}],this.dashboardPlugin=t}return t.prototype.execute=function(){this.apis.forEach(function(e){e().addTree()})},t}();e.OfficePowerPoint=t}(VORLON||(VORLON={}));
var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},$,VORLON;!function(e){var t=function(t){function i(){t.call(this,"office","control.html","control.css"),this._ready=!0,this.mailFunctions=new e.OfficeOutlook(this),this.documentFunctions=new e.OfficeDocument(this),this.pptxFunctions=new e.OfficePowerPoint(this)}return __extends(i,t),i.prototype.getID=function(){return"OFFICE"},i.prototype.startDashboardSide=function(e){var t=this;void 0===e&&(e=null),this._insertHtmlContentAsync(e,function(e){t._filledDiv=e,t._treeDiv=e.querySelector("#treeViewObj"),t.refreshButton=t._filledDiv.querySelector('x-action[event="refresh"]'),t.treeviewwrapper=t._filledDiv.querySelector(".tree-view-wrapper"),t.officetypeapp=t._filledDiv.querySelector("#office-type-app"),t.officePropertiesTitle=t._filledDiv.querySelector("#office-properties-title"),t.officePropertiesSection=t._filledDiv.querySelector("#office-properties"),t.clearTreeview(),t._filledDiv.addEventListener("refresh",function(){t.clearTreeview(),t.sendToClient({type:"query",name:"Office"}),t.sendToClient({type:"officetype"})});var i=$(e).parent();i.on("vorlon.plugins.active",function(){var e=$(".office-container");e.split({orientation:"vertical",limit:50,position:"70%"})}),t.sendToClient({type:"officetype"})})},i.prototype.update=function(e){this.constructTree(e.value,this._treeDiv),"Office"===e.name&&(this.sendToClient({type:"query",name:"OfficeExt"}),"Outlook"==this.officetype.officeType?this.mailFunctions.execute():"PowerPoint"==this.officetype.officeType?this.pptxFunctions.execute():(this.sendToClient({type:"query",name:"OfficeExtension"}),this.sendToClient({type:"query",name:"Excel"}),this.sendToClient({type:"query",name:"Word"}),this.documentFunctions.execute()))},i.prototype.clearTreeview=function(){for(;this._treeDiv.hasChildNodes();)this._treeDiv.removeChild(this._treeDiv.lastChild)},i.prototype.constructTree=function(t,i){var o=this;if(void 0!==t.properties&&0!==t.properties.length){var n=new e.FluentDOM("DIV","objdescriptor",i);n.append("DIV","expandable expanded",function(i){var n;i.attr("id",t.fullpath),i.append("DIV","expand",function(o){n=o.createChild("SPAN","expand-btn").text("-"),n.click(function(t){t.stopPropagation(),e.Tools.ToggleClass(i.element,"expanded",function(e){e?n.text("-"):n.text("+")})}),o.createChild("SPAN","expand-label").text(t.name),void 0!==t.value&&o.createChild("SPAN","prop-value").text(t.value)}),void 0!==t.properties&&i.append("DIV","expand-content",function(i){for(var n in t.properties){var r=t.properties[n];void 0!==r.properties?o.constructTree(r,i.element):i.append("DIV","obj-method",function(t){t.createChild("SPAN","prop-name").text(r.name),t.createChild("SPAN","prop-value").text(r.value),t.element.tag=r,t.click(function(t){t.stopPropagation(),e.OfficeTools.ShowProperty(t.target.parentElement.tag)})})}})})}},i.prototype.onRealtimeMessageReceivedFromClientSide=function(t){if("object"===t.type)this.update(t);else if("function"===t.type)e.OfficeTools.ShowFunctionResult(t);else if("officetype"===t.type){this.officetype=e.OfficeTools.GetOfficeType(t.value.officeType),this.treeviewwrapper.style.background=this.officetype.background;var i=this.officetype.officeType?this.officetype.officeType:"Office";i+=this.officetype.version?i+" "+this.officetype.version:"",this.officetypeapp.innerHTML=i,this.sendToClient({type:"query",name:"Office"})}else"error"===t.type&&e.OfficeTools.ShowFunctionResult(t)},i}(e.DashboardPlugin);e.OfficeDashboard=t,e.Core.RegisterDashboardPlugin(new t)}(VORLON||(VORLON={}));