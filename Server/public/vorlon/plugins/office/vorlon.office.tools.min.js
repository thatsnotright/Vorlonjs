var $,VORLON;!function(e){var t=function(){function t(){}return t.IsOutlook=function(){var e="window.Office.context.mailbox";return null!==document.getElementById(e)&&void 0!==document.getElementById(e)},t.AddTreeFunction=function(t,n){if(null!==document.getElementById(t)&&void 0!==document.getElementById(t)){var o=document.getElementById(t).querySelector(".expand-content"),r=new e.FluentDOM("DIV","obj-func",o),i=r.createChild("SPAN","func-name").text(n);return i}},t._ClearPropertiesAndResults=function(){var e=document.querySelector("#office-properties");if(void 0!==e&&null!==e)for(;e.hasChildNodes();)e.removeChild(e.lastChild)},t.GetOfficeType=function(e){return"Outlook"==e?{officeType:"Outlook",version:"",background:"#0173C7"}:e.wordapi?{officeType:"Word",version:e.wordapi,background:"#2A579A"}:e.excelapi?{officeType:"Excel",version:e.excelapi,background:"#227447"}:e.excelapi||e.wordapi?e.project?{officeType:"Project",version:e.projectapi,background:"#2E7237"}:{officeType:"Office",version:"1.0",background:"#0173C7"}:{officeType:"PowerPoint",version:e.pdf,background:"#B7472A"}},t.ShowFunctionResult=function(e){void 0!==e.value&&null!==e.value&&(e.value=JSON.parse(e.value));var n=JSON.stringify(e.value,void 0,4),o=document.querySelector("#office-properties"),r=document.querySelector("#office-results-values");if(void 0!==r&&null!==r)for(;r.hasChildNodes();)r.removeChild(r.lastChild);else r=document.createElement("DIV"),r.className="office-results-values",r.id="office-results-values",o.appendChild(r);var i=document.createElement("pre");i.className="results",i.innerHTML=t.FormatJson(n),r.appendChild(i)},t.FormatJson=function(e){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})},t.ShowFunction=function(t,n,o){e.OfficeTools._ClearPropertiesAndResults();var r=document.querySelector("#office-properties"),i=document.querySelector("#office-properties-title");i.innerHTML="Function";var a=new e.FluentDOM("DIV","office-properties-values",r);if(a.append("div","fullpath",function(e){e.createChild("SPAN","function-name").text("Function"),e.createChild("SPAN","function-value").text(t)}),void 0!==o&&o.length>0)for(var l in o){var u=o[l];a.append("div","options",function(e){e.createChild("SPAN","function-name").text(u.attributes.getNamedItem("tag").value),e.element.appendChild(u)})}a.append("div","invoker",function(o){var r=new e.FluentDOM("INPUT","function-invoker",o.element);r.attr("type","button"),r.attr("value","invoke"),r.attr("id",t),r.click(n)})},t.ShowProperty=function(t){e.OfficeTools._ClearPropertiesAndResults();var n=document.querySelector("#office-properties"),o=document.querySelector("#office-properties-title");o.innerHTML="Property";var r=new e.FluentDOM("DIV","office-properties-values",n);r.append("div","prop-fullpath",function(e){e.createChild("SPAN","name").text("Name"),e.createChild("SPAN","value").text(t.fullpath)}),r.append("div","prop-name",function(e){e.createChild("SPAN","name").text("Type"),e.createChild("SPAN","value").text(t.type)}),r.append("div","prop-type",function(e){e.createChild("SPAN","name").text("Value"),e.createChild("SPAN","value").text(t.value)})},t.AddZone=function(t,n){if(null!==document.getElementById(t)&&void 0!==document.getElementById(t)&&(null===document.getElementById(t+"."+n)||void 0===document.getElementById(t+"."+n))){var o=document.getElementById(t).children[1],r=new e.FluentDOM("DIV","objdescriptor",o);r.append("DIV","expandable expanded",function(o){var r;o.attr("id",t+"."+n),o.append("DIV","expand",function(t){r=t.createChild("SPAN","expand-btn").text("-"),r.click(function(t){t.stopPropagation(),e.Tools.ToggleClass(o.element,"expanded",function(e){e?r.text("-"):r.text("+")})}),t.createChild("SPAN","expand-label").text(n)}),o.append("DIV","expand-content",function(){})})}},t.CreateTextArea=function(e,t,n){var o=document.createElement("textarea");return o.setAttribute("rows","4"),o.setAttribute("cols","40"),o.setAttribute("name",e),o.setAttribute("id",e),n&&(o.value=n),o.setAttribute("tag",t+": "),o},t.CreateTextBlock=function(e,t,n){var o=document.createElement("input");return o.setAttribute("type","text"),o.setAttribute("name",e+".coercionType"),o.setAttribute("id",e+".coercionType "),void 0!==n&&(o.value=n),o.setAttribute("tag",t+" : "),o},t}();e.OfficeTools=t}(VORLON||(VORLON={}));